<!DOCTYPE html>
<html>
  <head>
    <title>Faye + Connect testing</title>
  </head>
  <body>
    <ul id="messages"></ul>
    <form id="sender">
      <p>
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" />
      </p>
      <p>
        <label for="name">Message:</label>
        <input type="text" id="message" name="message" />
        <input type="submit" value="Send" />
      </p>
    </form>
      
    <script type="text/javascript" src="/bayeux/client.js"></script>
    <script type="text/javascript" src="/underscore-1.0.2.js"></script>
    <script type="text/javascript" src="/jquery-1.4.2.js"></script>
    <script type="text/javascript">
      $(function() {
        var client  = new Faye.Client(),
            channel = "/chat";

        client.subscribe(channel, function(message) {
          $("<li>" + message.name + ": " + message.message + "</li>").appendTo("#messages");
        });

        $("#sender").submit(function() {
          var name       = $("#name").val(),
              messageBox = $("#message");

          client.publish(channel, {
            name:    name,
            message: messageBox.val()
          });

          messageBox.val("");

          return false;
        });
      });
    </script>
  </body>
</html>
